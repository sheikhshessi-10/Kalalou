<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalalou Hero</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #F7F4EF;
            --ink: #1C1C1C;
            --secondary: #6F6F6F;
            --accent: #B46A4C;
            --divider: #DDD8D0;
            --card: #FFFFFF;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--ink);
            line-height: 1.8;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        /* Hero Section */
        .hero {
            position: relative;
            width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 60px;
            text-align: center;
            overflow: hidden;
        }

        .hero-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            display: block;
            background: var(--bg-primary);
        }

        .hero-carousel {
            position: relative;
            width: 100%;
            max-width: 800px;
            z-index: 10;
        }

        .hero-slides {
            display: flex;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .hero-slide {
            min-width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding-bottom: 80px;
        }

        .hero h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(3.5rem, 7vw, 6rem);
            font-weight: 400;
            letter-spacing: -0.02em;
            margin-bottom: 32px;
            line-height: 1.1;
            color: var(--ink);
        }

        .hero-subtext {
            font-size: 1.1rem;
            color: var(--secondary);
            font-weight: 400;
            margin-bottom: 60px;
            max-width: 500px;
            letter-spacing: 0.01em;
        }

        .hero-divider {
            width: 60px;
            height: 1px;
            background: var(--divider);
            margin: 0 auto;
        }

        /* Brian Introduction */
        .brian-intro {
            margin-top: 20px;
            text-align: center;
            max-width: 700px;
            padding: 0 20px;
        }

        .brian-headline {
            font-size: 1.6rem;
            color: var(--ink);
            margin-bottom: 16px;
            line-height: 1.4;
            font-weight: 500;
        }

        .brian-name {
            color: var(--accent);
            font-weight: 700;
            font-size: 1.8rem;
        }

        .brian-feature {
            font-size: 1.3rem;
            color: var(--ink-light);
            margin-bottom: 24px;
            font-style: italic;
        }

        .brian-cta {
            font-size: 1.5rem;
            color: var(--accent);
            font-weight: 600;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        @media (max-width: 768px) {
            .brian-headline {
                font-size: 1.3rem;
            }
            .brian-name {
                font-size: 1.5rem;
            }
            .brian-feature {
                font-size: 1.1rem;
            }
            .brian-cta {
                font-size: 1.2rem;
            }
        }

        /* Carousel Navigation */
        .carousel-nav {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 16px;
            z-index: 10;
        }

        .carousel-button {
            width: 48px;
            height: 48px;
            background: var(--card);
            border: 1px solid var(--divider);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 20px;
            color: var(--ink);
        }

        .carousel-button:hover {
            background: var(--ink);
            color: var(--card);
            transform: scale(1.05);
        }

        .carousel-dots {
            position: absolute;
            bottom: 140px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
        }

        .carousel-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--divider);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .carousel-dot.active {
            background: var(--accent);
            width: 24px;
            border-radius: 4px;
        }

        /* Scroll Down Button */
        .scroll-down-container {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 10;
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .scroll-down-button {
            width: 56px;
            height: 56px;
            background: var(--card);
            border: 1px solid var(--divider);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--ink);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            animation: bounce 2s ease-in-out infinite;
        }

        .scroll-down-button:hover {
            background: var(--ink);
            color: var(--card);
            transform: translateY(4px) scale(1.05);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            animation: none;
        }

        .scroll-down-button svg {
            width: 24px;
            height: 24px;
        }

        /* Artwork Slide */
        .artwork-slide {
            padding: 40px;
        }

        .artwork-image {
            max-width: 900px;
            width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08);
        }

        @media (max-width: 768px) {
            .hero {
                padding: 40px 30px;
            }
        }

        /* Form Section */
        .form-section {
            position: relative;
            width: 100%;
            background: var(--bg-primary);
            padding: 80px 60px;
            z-index: 10;
            overflow: hidden;
            display: none; /* Hidden until login */
        }

        /* Thank You Section */
        .thank-you-section {
            position: relative;
            width: 100%;
            min-height: 100vh;
            display: none; /* Hidden until submission */
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 60px;
            text-align: center;
            overflow: hidden;
            z-index: 10;
        }

        .thank-you-section.show {
            display: flex;
        }

        .thank-you-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            display: block;
            background: var(--bg-primary);
        }

        .thank-you-content {
            position: relative;
            z-index: 10;
            max-width: 800px;
        }

        .thank-you-section h1 {
            font-family: 'Playfair Display', serif;
            font-size: clamp(3rem, 6vw, 5rem);
            font-weight: 400;
            letter-spacing: -0.02em;
            margin-bottom: 24px;
            line-height: 1.1;
            color: var(--ink);
        }

        .thank-you-section p {
            font-size: 1.2rem;
            color: var(--secondary);
            margin-bottom: 40px;
            font-weight: 400;
            line-height: 1.6;
        }

        .submit-again-button {
            padding: 16px 40px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            margin-top: 20px;
        }

        .submit-again-button:hover {
            background: #9d5a3f;
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(180, 106, 76, 0.3);
        }

        .form-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            display: block;
            background: var(--bg-primary);
        }

        .form-container {
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
            z-index: 10;
        }

        .form-section-title {
            font-family: 'Playfair Display', serif;
            font-size: clamp(2rem, 4vw, 3rem);
            font-weight: 400;
            color: var(--ink);
            margin-bottom: 12px;
            letter-spacing: -0.02em;
        }

        .form-section-subtitle {
            font-size: 1.1rem;
            color: var(--secondary);
            margin-bottom: 50px;
            font-weight: 400;
        }

        .form-card {
            background: var(--card);
            border-radius: 12px;
            padding: 50px;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 60px;
        }

        .question-group {
            margin-bottom: 40px;
        }

        .question-label {
            display: block;
            font-weight: 500;
            color: var(--ink);
            margin-bottom: 16px;
            font-size: 1.05rem;
            line-height: 1.6;
        }

        .question-helper {
            font-size: 0.9rem;
            color: var(--secondary);
            margin-top: 8px;
            font-style: italic;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="number"],
        textarea {
            width: 100%;
            padding: 14px 18px;
            border: 1px solid var(--divider);
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            background: var(--bg-primary);
            color: var(--ink);
            transition: all 0.3s ease;
        }

        input:focus,
        textarea:focus {
            outline: none;
            border-color: var(--accent);
            background: white;
            box-shadow: 0 0 0 3px rgba(180, 106, 76, 0.1);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        .radio-group,
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 12px;
        }

        .radio-option,
        .checkbox-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 8px;
            transition: background 0.2s ease;
        }

        .radio-option:hover,
        .checkbox-option:hover {
            background: rgba(180, 106, 76, 0.05);
        }

        input[type="radio"],
        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: var(--accent);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
            background: var(--card);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 16px;
            text-align: left;
            border-bottom: 1px solid var(--divider);
        }

        th {
            background: var(--bg-primary);
            font-weight: 600;
            color: var(--ink);
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        td input[type="number"],
        td input[type="text"] {
            width: 100%;
            min-width: 80px;
            padding: 10px 12px;
            margin: 0;
        }

        .priority-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }

        .priority-table th,
        .priority-table td {
            padding: 14px;
            text-align: center;
            border: 1px solid var(--divider);
        }

        .priority-table th {
            background: var(--bg-primary);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .priority-table td {
            background: var(--card);
        }

        .priority-table input[type="radio"] {
            margin: 0 auto;
        }

        .submit-button {
            width: 100%;
            padding: 18px 40px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 40px;
            font-family: 'Inter', sans-serif;
        }

        .submit-button:hover {
            background: #9d5a3f;
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(180, 106, 76, 0.3);
        }

        .note {
            background: rgba(180, 106, 76, 0.1);
            padding: 18px;
            border-radius: 8px;
            border-left: 4px solid var(--accent);
            margin: 30px 0;
            font-size: 0.95rem;
            color: var(--secondary);
            line-height: 1.6;
        }

        .section-divider {
            height: 1px;
            background: var(--divider);
            margin: 60px 0;
        }

        .autosave-indicator {
            position: fixed;
            right: 16px;
            bottom: 16px;
            background: var(--card);
            border: 1px solid var(--divider);
            border-radius: 999px;
            padding: 10px 14px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.10);
            color: var(--secondary);
            font-size: 0.95rem;
            opacity: 0;
            transform: translateY(8px);
            transition: opacity 0.18s ease, transform 0.18s ease;
            z-index: 1000;
            pointer-events: none;
        }

        .autosave-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* Login Modal */
        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            backdrop-filter: blur(4px);
        }

        .login-overlay.hidden {
            display: none;
        }

        .login-card {
            background: var(--card);
            border-radius: 16px;
            padding: 50px;
            max-width: 450px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .login-card h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            color: var(--ink);
            margin-bottom: 12px;
        }

        .login-card p {
            color: var(--secondary);
            margin-bottom: 30px;
            font-size: 0.95rem;
        }

        .login-form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .login-form-group label {
            display: block;
            font-weight: 500;
            color: var(--ink);
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .login-form-group input {
            width: 100%;
            padding: 14px 18px;
            border: 1px solid var(--divider);
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            background: var(--bg-primary);
            color: var(--ink);
            transition: all 0.3s ease;
        }

        .login-form-group input:focus {
            outline: none;
            border-color: var(--accent);
            background: white;
            box-shadow: 0 0 0 3px rgba(180, 106, 76, 0.1);
        }

        .login-error {
            color: #d32f2f;
            font-size: 0.9rem;
            margin-top: 8px;
            display: none;
        }

        .login-error.show {
            display: block;
        }

        .login-button {
            width: 100%;
            padding: 16px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            font-family: 'Inter', sans-serif;
        }

        .login-button:hover {
            background: #9d5a3f;
            transform: translateY(-2px);
            box-shadow: 0 6px 24px rgba(180, 106, 76, 0.3);
        }

        .login-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .user-info {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--card);
            border: 1px solid var(--divider);
            border-radius: 8px;
            padding: 12px 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            display: none;
        }

        .user-info.show {
            display: block;
        }

        .user-info span {
            color: var(--ink);
            font-weight: 500;
            font-size: 0.95rem;
        }

        .user-info .logout-btn {
            margin-left: 12px;
            color: var(--accent);
            cursor: pointer;
            text-decoration: underline;
            font-size: 0.9rem;
        }

        .user-info .logout-btn:hover {
            color: #9d5a3f;
        }

        @media (max-width: 768px) {
            .form-section {
                padding: 60px 30px;
            }

            .form-card {
                padding: 30px 25px;
            }

            table {
                font-size: 0.9rem;
            }

            th, td {
                padding: 12px 8px;
            }
        }
    </style>
</head>
<body>
    <!-- Login Modal -->
    <div class="login-overlay" id="loginOverlay">
        <div class="login-card">
            <h2>Welcome</h2>
            <p>Please login to access the questionnaire</p>
            <form id="loginForm" onsubmit="return false;">
                <div class="login-form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" name="username" required autocomplete="username">
                    <div class="login-error" id="usernameError">Please enter a username</div>
                </div>
                <div class="login-form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required autocomplete="current-password">
                    <div class="login-error" id="passwordError">Please enter a password</div>
                </div>
                <div class="login-error" id="loginError">Invalid username or password</div>
                <button type="submit" class="login-button" id="loginButton">Login</button>
            </form>
        </div>
    </div>

    <!-- User Info -->
    <div class="user-info" id="userInfo">
        <span>Logged in as: <strong id="currentUsername"></strong></span>
        <span class="logout-btn" id="logoutBtn">Logout</span>
    </div>

    <!-- Hero -->
    <section class="hero">
        <canvas class="hero-canvas" id="heroCanvas"></canvas>
        <div class="hero-carousel">
            <div class="hero-slides" id="heroSlides">
                <!-- Slide 1: Main Title -->
                <div class="hero-slide">
                    <h1>KALALOU AI LEVERAGE</h1>
                    <div class="hero-divider"></div>
                    
                    <!-- Brian Introduction -->
                    <div class="brian-intro">
                        <p class="brian-headline">We are bringing into life a new team member for Kalalou, <span class="brian-name">Brian!</span></p>
                        <p class="brian-feature">Brian works 24/7, never sleeps, never takes a day off!</p>
                        <p class="brian-cta">Help us decide Superpowers for Brian:</p>
                    </div>
                </div>
            </div>

            <!-- Scroll Down Button -->
            <div class="scroll-down-container">
                <button class="scroll-down-button" id="scrollDownButton" aria-label="Scroll to form">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M6 9l6 6 6-6"/>
                    </svg>
                </button>
            </div>
        </div>
    </section>

    <!-- Form Section -->
    <section class="form-section">
        <canvas class="form-canvas" id="formCanvas"></canvas>
        <div class="form-container">
            <form id="mainForm">
                
                <div class="note">
                    Your progress is saved automatically as you type. You can close this page and come back anytime.
                </div>

                <!-- INBOUND AI SECTION -->
                <div class="form-card">
                    <h2 class="form-section-title">INBOUND SYSTEM</h2>
                    <p class="form-section-subtitle">AI takes all the calls while your team focus on adding more clients</p>
                    
                    <div class="question-group">
                        <label class="question-label">Current inbound call volume (approximately):<br>How many inbound calls do you receive per month?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="inbound_calls_range" value="500-1000">500-1,000</label>
                            <label class="radio-option"><input type="radio" name="inbound_calls_range" value="1000-1500">1,000-1,500</label>
                            <label class="radio-option"><input type="radio" name="inbound_calls_range" value="1500-2500">1,500-2,500</label>
                            <label class="radio-option"><input type="radio" name="inbound_calls_range" value="2500+">2,500+</label>
                            <label class="radio-option"><input type="radio" name="inbound_calls_range" value="not_sure">Not sure (we'll help you track this)</label>
                        </div>
                        <div class="question-helper">If you have data, exact number:</div>
                        <input type="number" name="inbound_calls_exact" placeholder="calls/month" min="0">
                    </div>

                    <div class="question-group">
                        <label class="question-label">Caller breakdown (estimate %):<br>Who is calling us at Kalalou</label>
                        <table>
                            <tr><th>Caller Type</th><th>Percentage</th></tr>
                            <tr><td>Existing customers</td><td><input type="number" name="caller_existing_pct" min="0" max="100" placeholder="%"></td></tr>
                            <tr><td>New prospects</td><td><input type="number" name="caller_new_pct" min="0" max="100" placeholder="%"></td></tr>
                            <tr><td>Vendors/suppliers</td><td><input type="number" name="caller_vendors_pct" min="0" max="100" placeholder="%"></td></tr>
                            <tr><td>Other</td><td><input type="number" name="caller_other_pct" min="0" max="100" placeholder="%"></td></tr>
                        </table>
                    </div>

                    <div class="question-group">
                        <label class="question-label">What are customers calling about?</label>
                        <table>
                            <tr>
                                <th>Call Type</th>
                                <th style="text-align: center;">High volume</th>
                                <th style="text-align: center;">Occasional</th>
                                <th style="text-align: center;">Rarely/never</th>
                            </tr>
                            <tr>
                                <td>Product information/specifications</td>
                                <td style="text-align: center;"><input type="radio" name="call_type_product" value="high_volume"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_product" value="occasional"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_product" value="rarely_never"></td>
                            </tr>
                            <tr>
                                <td>Pricing inquiries</td>
                                <td style="text-align: center;"><input type="radio" name="call_type_pricing" value="high_volume"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_pricing" value="occasional"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_pricing" value="rarely_never"></td>
                            </tr>
                            <tr>
                                <td>Order status/tracking</td>
                                <td style="text-align: center;"><input type="radio" name="call_type_order_status" value="high_volume"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_order_status" value="occasional"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_order_status" value="rarely_never"></td>
                            </tr>
                            <tr>
                                <td>Inventory availability ("Do you have X in stock?")</td>
                                <td style="text-align: center;"><input type="radio" name="call_type_inventory" value="high_volume"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_inventory" value="occasional"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_inventory" value="rarely_never"></td>
                            </tr>
                            <tr>
                                <td>Account questions (login, payment terms, etc.)</td>
                                <td style="text-align: center;"><input type="radio" name="call_type_account" value="high_volume"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_account" value="occasional"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_account" value="rarely_never"></td>
                            </tr>
                            <tr>
                                <td>New customer inquiry (requesting catalog)</td>
                                <td style="text-align: center;"><input type="radio" name="call_type_new_customer" value="high_volume"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_new_customer" value="occasional"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_new_customer" value="rarely_never"></td>
                            </tr>
                            <tr>
                                <td>Placing an order</td>
                                <td style="text-align: center;"><input type="radio" name="call_type_placing_order" value="high_volume"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_placing_order" value="occasional"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_placing_order" value="rarely_never"></td>
                            </tr>
                            <tr>
                                <td>Returns/complaints/issues</td>
                                <td style="text-align: center;"><input type="radio" name="call_type_returns" value="high_volume"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_returns" value="occasional"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_returns" value="rarely_never"></td>
                            </tr>
                            <tr>
                                <td>Shipping information</td>
                                <td style="text-align: center;"><input type="radio" name="call_type_shipping" value="high_volume"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_shipping" value="occasional"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_shipping" value="rarely_never"></td>
                            </tr>
                            <tr>
                                <td>Other: <input type="text" name="call_type_other_label" placeholder="Describe..." style="width: 200px; display: inline-block; margin-left: 8px;"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_other" value="high_volume"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_other" value="occasional"></td>
                                <td style="text-align: center;"><input type="radio" name="call_type_other" value="rarely_never"></td>
                            </tr>
                        </table>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Information requirements:<br>What percentage of calls can be answered with general product knowledge (no customer-specific data needed)?<br><span style="font-size: 0.9rem; font-weight: normal; color: var(--secondary);">Example: "What materials is this basket made from?" vs. "What's the status of MY order?"</span></label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="general_knowledge_pct" value="0-25">0-25% (most calls need account lookup)</label>
                            <label class="radio-option"><input type="radio" name="general_knowledge_pct" value="25-50">25-50%</label>
                            <label class="radio-option"><input type="radio" name="general_knowledge_pct" value="50-75">50-75%</label>
                            <label class="radio-option"><input type="radio" name="general_knowledge_pct" value="75-100">75-100% (most are general questions)</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Customer-specific lookups:<br>What percentage of calls require looking up customer-specific information (order history, account status, tracking, etc.)?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="customer_lookup_pct" value="0-25">0-25%</label>
                            <label class="radio-option"><input type="radio" name="customer_lookup_pct" value="25-50">25-50%</label>
                            <label class="radio-option"><input type="radio" name="customer_lookup_pct" value="50-75">50-75%</label>
                            <label class="radio-option"><input type="radio" name="customer_lookup_pct" value="75-100">75-100%</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Order taking - should AI handle this?<br>What level of order-taking capability do you need?</label>
                        <table class="priority-table">
                            <tr><th>Capability</th><th>✅</th><th>⭐</th><th>❌</th></tr>
                            <tr>
                                <td style="text-align: left;">Take simple repeat orders (customer knows item numbers)</td>
                                <td><input type="radio" name="order_repeat" value="must"></td>
                                <td><input type="radio" name="order_repeat" value="nice"></td>
                                <td><input type="radio" name="order_repeat" value="no"></td>
                            </tr>
                            <tr>
                                <td style="text-align: left;">Take new orders (customer browsing, asking questions)</td>
                                <td><input type="radio" name="order_new" value="must"></td>
                                <td><input type="radio" name="order_new" value="nice"></td>
                                <td><input type="radio" name="order_new" value="no"></td>
                            </tr>
                            <tr>
                                <td style="text-align: left;">Collect order details and email to sales team</td>
                                <td><input type="radio" name="order_email" value="must"></td>
                                <td><input type="radio" name="order_email" value="nice"></td>
                                <td><input type="radio" name="order_email" value="no"></td>
                            </tr>
                            <tr>
                                <td style="text-align: left;">Don't take orders at all (transfer to sales)</td>
                                <td><input type="radio" name="order_transfer" value="must"></td>
                                <td><input type="radio" name="order_transfer" value="nice"></td>
                                <td><input type="radio" name="order_transfer" value="no"></td>
                            </tr>
                        </table>
                        <div class="question-helper" style="margin-top: 12px;">Your preferred approach:</div>
                        <input type="text" name="order_preferred_approach" placeholder="Describe your ideal order-taking approach...">
                    </div>

                    <div class="question-group">
                        <label class="question-label">Inventory checking:<br>Should AI be able to check real-time inventory/stock levels?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="inventory_checking" value="must">✅ MUST-HAVE - Customers ask this constantly, critical feature</label>
                            <label class="radio-option"><input type="radio" name="inventory_checking" value="nice">⭐ NICE-TO-HAVE - Would be helpful but not critical</label>
                            <label class="radio-option"><input type="radio" name="inventory_checking" value="no">❌ NOT NEEDED - We'll handle this manually/transfer to team</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Order status lookup:<br>Should AI be able to look up order status and tracking information?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="order_status_lookup" value="must">✅ MUST-HAVE - Very common question, need this</label>
                            <label class="radio-option"><input type="radio" name="order_status_lookup" value="nice">⭐ NICE-TO-HAVE - Would reduce call transfers</label>
                            <label class="radio-option"><input type="radio" name="order_status_lookup" value="no">❌ NOT NEEDED - Transfer these calls to our team</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">What abilities would you want the AI to have?</label>
                        <table class="priority-table">
                            <tr><th>System Integration</th><th>✅</th><th>⭐</th><th>❌</th></tr>
                            <tr>
                                <td style="text-align: left;">Read customer data (account info, contact details)</td>
                                <td><input type="radio" name="integration_netsuite_customer" value="must"></td>
                                <td><input type="radio" name="integration_netsuite_customer" value="nice"></td>
                                <td><input type="radio" name="integration_netsuite_customer" value="no"></td>
                            </tr>
                            <tr>
                                <td style="text-align: left;">Read order history (past purchases, dates)</td>
                                <td><input type="radio" name="integration_netsuite_history" value="must"></td>
                                <td><input type="radio" name="integration_netsuite_history" value="nice"></td>
                                <td><input type="radio" name="integration_netsuite_history" value="no"></td>
                            </tr>
                            <tr>
                                <td style="text-align: left;">Check inventory levels (real-time stock)</td>
                                <td><input type="radio" name="integration_netsuite_inventory" value="must"></td>
                                <td><input type="radio" name="integration_netsuite_inventory" value="nice"></td>
                                <td><input type="radio" name="integration_netsuite_inventory" value="no"></td>
                            </tr>
                            <tr>
                                <td style="text-align: left;">Create new orders (AI places order in system)</td>
                                <td><input type="radio" name="integration_netsuite_create" value="must"></td>
                                <td><input type="radio" name="integration_netsuite_create" value="nice"></td>
                                <td><input type="radio" name="integration_netsuite_create" value="no"></td>
                            </tr>
                            <tr>
                                <td style="text-align: left;">Product catalog/information</td>
                                <td><input type="radio" name="integration_magento_catalog" value="must"></td>
                                <td><input type="radio" name="integration_magento_catalog" value="nice"></td>
                                <td><input type="radio" name="integration_magento_catalog" value="no"></td>
                            </tr>
                            <tr>
                                <td style="text-align: left;">Pricing information (wholesale tiers)</td>
                                <td><input type="radio" name="integration_magento_pricing" value="must"></td>
                                <td><input type="radio" name="integration_magento_pricing" value="nice"></td>
                                <td><input type="radio" name="integration_magento_pricing" value="no"></td>
                            </tr>
                            <tr>
                                <td style="text-align: left;">Email system - Send confirmations/follow-ups</td>
                                <td><input type="radio" name="integration_email" value="must"></td>
                                <td><input type="radio" name="integration_email" value="nice"></td>
                                <td><input type="radio" name="integration_email" value="no"></td>
                            </tr>
                            <tr>
                                <td style="text-align: left;">Calendar system - Schedule callbacks (Google/Outlook)</td>
                                <td><input type="radio" name="integration_calendar" value="must"></td>
                                <td><input type="radio" name="integration_calendar" value="nice"></td>
                                <td><input type="radio" name="integration_calendar" value="no"></td>
                            </tr>
                            <tr>
                                <td style="text-align: left;">Other: <input type="text" name="integration_other_label" placeholder="System name..." style="width: 200px; display: inline-block; margin-left: 8px;"></td>
                                <td><input type="radio" name="integration_other" value="must"></td>
                                <td><input type="radio" name="integration_other" value="nice"></td>
                                <td><input type="radio" name="integration_other" value="no"></td>
                            </tr>
                        </table>
                        <div class="question-helper" style="margin-top: 12px;">
                            <strong>Legend:</strong><br>
                            ✅ = Must-Have (critical for system to work)<br>
                            ⭐ = Nice-to-Have (valuable but not essential)<br>
                            ❌ = Not Needed (skip this integration)
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Call recordings:<br>Do you want recordings of customer calls?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="call_recordings" value="all">Yes, record all calls</label>
                            <label class="radio-option"><input type="radio" name="call_recordings" value="transfers_only">Only record calls that transfer to humans</label>
                            <label class="radio-option"><input type="radio" name="call_recordings" value="flagged_only">Only record flagged calls (complaints, issues)</label>
                            <label class="radio-option"><input type="radio" name="call_recordings" value="none">No recordings (just AI-generated summaries/transcripts)</label>
                        </div>
                        <div class="question-helper" style="margin-top: 16px;">Storage preference:</div>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="recording_storage" value="30_days">Store recordings for 30 days</label>
                            <label class="radio-option"><input type="radio" name="recording_storage" value="90_days">Store recordings for 90 days</label>
                            <label class="radio-option"><input type="radio" name="recording_storage" value="1_year">Store recordings for 1 year</label>
                            <label class="radio-option"><input type="radio" name="recording_storage" value="other">Other</label>
                        </div>
                        <input type="text" name="recording_storage_other" placeholder="If other, specify..." style="margin-top: 12px;">
                    </div>

                    <div class="question-group">
                        <label class="question-label">Special requirements:<br>Any special requirements, concerns, or considerations we should know about?</label>
                        <textarea name="special_requirements" placeholder="Share anything important for us to know..."></textarea>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Questions for us:<br>Any questions about the inbound AI system you'd like us to address on our call?</label>
                        <textarea name="questions_for_us" placeholder="Write your questions here..."></textarea>
                    </div>
                </div>

                <!-- OUTBOUND AI SYSTEM SECTION -->
                <div class="form-card">
                    <h2 class="form-section-title">OUTBOUND AI SYSTEM – LET'S UNLOCK LEVERAGE!</h2>
                    
                    <div class="question-group">
                        <label class="question-label">Primary objective:<br>What's the main goal of outbound calling? (Select all that apply)</label>
                        <div class="checkbox-group">
                            <label class="checkbox-option"><input type="checkbox" name="outbound_goals[]" value="book_meetings">Book meetings with sales team for new prospects</label>
                            <label class="checkbox-option"><input type="checkbox" name="outbound_goals[]" value="send_catalogs">Send catalogs to engaged prospects</label>
                            <label class="checkbox-option"><input type="checkbox" name="outbound_goals[]" value="maintain_relationships">Maintain relationships with existing customers</label>
                            <label class="checkbox-option"><input type="checkbox" name="outbound_goals[]" value="reactivate_dormant">Reactivate dormant customers (haven't ordered in 6+ months)</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Target call volume:<br>How many outbound calls per month do you want the AI to make?<br><span style="font-size: 0.9rem; font-weight: normal; color: var(--secondary);">(Give us a number to start, we can always scale this)</span></label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="outbound_target_volume" value="100-300">100-300 calls/month</label>
                            <label class="radio-option"><input type="radio" name="outbound_target_volume" value="300-500">300-500 calls/month</label>
                            <label class="radio-option"><input type="radio" name="outbound_target_volume" value="500-1000">500-1,000 calls/month</label>
                            <label class="radio-option"><input type="radio" name="outbound_target_volume" value="1000-2000">1,000-2,000 calls/month</label>
                            <label class="radio-option"><input type="radio" name="outbound_target_volume" value="2000+">2,000+ calls/month</label>
                            <label class="radio-option"><input type="radio" name="outbound_target_volume" value="start_small">Start small and scale based on results</label>
                        </div>
                        <div class="question-helper">Target number (if you have one):</div>
                        <input type="number" name="outbound_target_exact" placeholder="calls/month" min="0">
                    </div>

                    <div class="question-group">
                        <label class="question-label">Current outbound activity:<br>How many outbound calls does your team currently make per month?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="outbound_current_volume" value="0-100">0-100 (very little outbound)</label>
                            <label class="radio-option"><input type="radio" name="outbound_current_volume" value="100-300">100-300</label>
                            <label class="radio-option"><input type="radio" name="outbound_current_volume" value="300-500">300-500</label>
                            <label class="radio-option"><input type="radio" name="outbound_current_volume" value="500-1000">500-1,000</label>
                            <label class="radio-option"><input type="radio" name="outbound_current_volume" value="none">We don't do systematic outbound calling currently</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Who should the AI call?<br>Mark which groups you want to target:</label>
                        <table>
                            <tr><th>Target Audience</th><th>Call Them?</th><th>Est. Volume/Month</th></tr>
                            <tr>
                                <td>New prospects (from Lead Gen System we make)</td>
                                <td>
                                    <div style="display: flex; gap: 8px; justify-content: center;">
                                        <label style="cursor: pointer;"><input type="radio" name="target_new_prospects" value="yes" style="margin: 0 4px;">✅</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_new_prospects" value="priority" style="margin: 0 4px;">⭐</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_new_prospects" value="no" style="margin: 0 4px;">❌</label>
                                    </div>
                                </td>
                                <td><input type="number" name="target_new_prospects_volume" placeholder="calls" min="0"></td>
                            </tr>
                            <tr>
                                <td>Existing customers (relationship check-ins)</td>
                                <td>
                                    <div style="display: flex; gap: 8px; justify-content: center;">
                                        <label style="cursor: pointer;"><input type="radio" name="target_existing_customers" value="yes" style="margin: 0 4px;">✅</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_existing_customers" value="priority" style="margin: 0 4px;">⭐</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_existing_customers" value="no" style="margin: 0 4px;">❌</label>
                                    </div>
                                </td>
                                <td><input type="number" name="target_existing_customers_volume" placeholder="calls" min="0"></td>
                            </tr>
                            <tr>
                                <td>Dormant customers (no order in 6+ months)</td>
                                <td>
                                    <div style="display: flex; gap: 8px; justify-content: center;">
                                        <label style="cursor: pointer;"><input type="radio" name="target_dormant" value="yes" style="margin: 0 4px;">✅</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_dormant" value="priority" style="margin: 0 4px;">⭐</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_dormant" value="no" style="margin: 0 4px;">❌</label>
                                    </div>
                                </td>
                                <td><input type="number" name="target_dormant_volume" placeholder="calls" min="0"></td>
                            </tr>
                            <tr>
                                <td>Trade show leads</td>
                                <td>
                                    <div style="display: flex; gap: 8px; justify-content: center;">
                                        <label style="cursor: pointer;"><input type="radio" name="target_trade_show" value="yes" style="margin: 0 4px;">✅</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_trade_show" value="priority" style="margin: 0 4px;">⭐</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_trade_show" value="no" style="margin: 0 4px;">❌</label>
                                    </div>
                                </td>
                                <td><input type="number" name="target_trade_show_volume" placeholder="calls" min="0"></td>
                            </tr>
                            <tr>
                                <td>Referrals</td>
                                <td>
                                    <div style="display: flex; gap: 8px; justify-content: center;">
                                        <label style="cursor: pointer;"><input type="radio" name="target_referrals" value="yes" style="margin: 0 4px;">✅</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_referrals" value="priority" style="margin: 0 4px;">⭐</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_referrals" value="no" style="margin: 0 4px;">❌</label>
                                    </div>
                                </td>
                                <td><input type="number" name="target_referrals_volume" placeholder="calls" min="0"></td>
                            </tr>
                            <tr>
                                <td>Other: <input type="text" name="target_other_label" placeholder="Specify..." style="width: 200px; display: inline-block; margin-left: 8px;"></td>
                                <td>
                                    <div style="display: flex; gap: 8px; justify-content: center;">
                                        <label style="cursor: pointer;"><input type="radio" name="target_other" value="yes" style="margin: 0 4px;">✅</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_other" value="priority" style="margin: 0 4px;">⭐</label>
                                        <label style="cursor: pointer;"><input type="radio" name="target_other" value="no" style="margin: 0 4px;">❌</label>
                                    </div>
                                </td>
                                <td><input type="number" name="target_other_volume" placeholder="calls" min="0"></td>
                            </tr>
                        </table>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Calling strategy:<br>Which prospects should AI call?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="calling_strategy" value="warm_only">Only warm leads - opened email, clicked link, or engaged with content</label>
                            <label class="radio-option"><input type="radio" name="calling_strategy" value="all_database">All prospects in database - relationship maintenance approach</label>
                            <label class="radio-option"><input type="radio" name="calling_strategy" value="mixed">Mixed approach - warm leads only for new prospects, all existing customers</label>
                            <label class="radio-option"><input type="radio" name="calling_strategy" value="discuss">Let's discuss compliance and best approach on our call</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">What counts as a successful call?<br>What's your primary desired outcome? (Pick ONE)</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="success_outcome" value="catalog">A. Customer agrees to receive catalog (email or mail)</label>
                            <label class="radio-option"><input type="radio" name="success_outcome" value="meeting">B. Customer books a meeting with your sales team</label>
                            <label class="radio-option"><input type="radio" name="success_outcome" value="order">C. Customer places an order on the spot</label>
                            <label class="radio-option"><input type="radio" name="success_outcome" value="qualifying">D. Customer provides feedback/information (qualifying)</label>
                            <label class="radio-option"><input type="radio" name="success_outcome" value="other">E. Other: <input type="text" name="success_outcome_other" placeholder="Specify..." style="width: 300px; display: inline-block; margin-left: 8px;"></label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">When customer asks to transfer call, how should AI distribute?<br><span style="font-size: 0.9rem; font-weight: normal; color: var(--secondary);">(In our meeting Doug wanted to do round robin, where anyone available can pick the call)</span></label>
                        <div class="question-helper">Distribution method:</div>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="transfer_distribution" value="round_robin">Round-robin (distribute evenly across team)</label>
                            <label class="radio-option"><input type="radio" name="transfer_distribution" value="one_person">All meetings to one person: <input type="text" name="transfer_one_person" placeholder="Name" style="width: 200px; display: inline-block; margin-left: 8px;"></label>
                            <label class="radio-option"><input type="radio" name="transfer_distribution" value="geography">Based on geography/territory</label>
                            <label class="radio-option"><input type="radio" name="transfer_distribution" value="prospect_type">Based on prospect type (new vs. existing)</label>
                            <label class="radio-option"><input type="radio" name="transfer_distribution" value="no_booking">AI doesn't book meetings (just collects information)</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Voicemail handling:<br>What should AI do if it reaches voicemail?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="voicemail_action" value="leave_message">Option A: Leave a brief message with callback number</label>
                            <label class="radio-option"><input type="radio" name="voicemail_action" value="email">Option B: Hang up and send follow-up email instead</label>
                            <label class="radio-option"><input type="radio" name="voicemail_action" value="retry">Option C: Hang up and retry later (2-3 attempts max)</label>
                            <label class="radio-option"><input type="radio" name="voicemail_action" value="combination">Option D: Combination approach (specify): <input type="text" name="voicemail_combination" placeholder="Describe..." style="width: 250px; display: inline-block; margin-left: 8px;"></label>
                            <label class="radio-option"><input type="radio" name="voicemail_action" value="other">Option E: Other: <input type="text" name="voicemail_other" placeholder="Specify..." style="width: 250px; display: inline-block; margin-left: 8px;"></label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Additional notes:<br>Anything else we should know about your outbound calling strategy?</label>
                        <textarea name="outbound_additional_notes" placeholder="Share any additional information..."></textarea>
                    </div>
                </div>

                <!-- LEAD GENERATION SYSTEM SECTION -->
                <div class="form-card">
                    <h2 class="form-section-title">LEAD GENERATION SYSTEM - THE VERY HEART OF OUTBOUND!</h2>
                    
                    <div class="question-group">
                        <label class="question-label">Target store types:<br>What types of retailers should we find? (Check all that apply)</label>
                        <div class="checkbox-group">
                            <label class="checkbox-option"><input type="checkbox" name="store_types[]" value="independent_gift">Independent gift shops</label>
                            <label class="checkbox-option"><input type="checkbox" name="store_types[]" value="home_decor">Home decor boutiques</label>
                            <label class="checkbox-option"><input type="checkbox" name="store_types[]" value="garden_centers">Garden centers with gift/decor sections</label>
                            <label class="checkbox-option"><input type="checkbox" name="store_types[]" value="furniture_stores">Furniture stores with home accessories</label>
                            <label class="checkbox-option"><input type="checkbox" name="store_types[]" value="specialty_stores">Specialty stores (coastal, farmhouse, boho, etc.)</label>
                            <label class="checkbox-option"><input type="checkbox" name="store_types[]" value="department_stores">Department stores (gift/home decor sections)</label>
                            <label class="checkbox-option"><input type="checkbox" name="store_types[]" value="lifestyle_stores">Lifestyle stores (mix of apparel, gifts, home)</label>
                            <label class="checkbox-option"><input type="checkbox" name="store_types[]" value="museum_gift">Museum/gallery gift shops</label>
                            <label class="checkbox-option"><input type="checkbox" name="store_types[]" value="hotel_gift">Hotel/resort gift shops</label>
                            <label class="checkbox-option"><input type="checkbox" name="store_types[]" value="other">Other: <input type="text" name="store_types_other" placeholder="Specify..." style="width: 250px; display: inline-block; margin-left: 8px;"></label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Store size preference:<br>What annual revenue range works best for you?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="store_size" value="250k-500k">$250K-$500K (very small boutiques)</label>
                            <label class="radio-option"><input type="radio" name="store_size" value="500k-1m">$500K-$1M (small independent shops)</label>
                            <label class="radio-option"><input type="radio" name="store_size" value="1m-2m">$1M-$2M (established independent stores)</label>
                            <label class="radio-option"><input type="radio" name="store_size" value="2m-5m">$2M-$5M (larger stores/small chains)</label>
                            <label class="radio-option"><input type="radio" name="store_size" value="5m-10m">$5M-$10M (regional chains)</label>
                            <label class="radio-option"><input type="radio" name="store_size" value="10m+">$10M+ (larger chains)</label>
                            <label class="radio-option"><input type="radio" name="store_size" value="all_sizes">All sizes welcome</label>
                            <label class="radio-option"><input type="radio" name="store_size" value="sweet_spot">Sweet spot: $<input type="number" name="store_size_min" placeholder="min" min="0" style="width: 120px; display: inline-block; margin: 0 8px;"> to $<input type="number" name="store_size_max" placeholder="max" min="0" style="width: 120px; display: inline-block; margin-left: 8px;"> annual revenue</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Aesthetic/style preference:<br>What aesthetic should target stores have?</label>
                        <div class="checkbox-group">
                            <label class="checkbox-option"><input type="checkbox" name="aesthetic[]" value="farmhouse_rustic">Farmhouse/Rustic</label>
                            <label class="checkbox-option"><input type="checkbox" name="aesthetic[]" value="coastal_beach">Coastal/Beach/Nautical</label>
                            <label class="checkbox-option"><input type="checkbox" name="aesthetic[]" value="boho_eclectic">Boho/Eclectic</label>
                            <label class="checkbox-option"><input type="checkbox" name="aesthetic[]" value="modern_contemporary">Modern/Contemporary</label>
                            <label class="checkbox-option"><input type="checkbox" name="aesthetic[]" value="traditional_classic">Traditional/Classic</label>
                            <label class="checkbox-option"><input type="checkbox" name="aesthetic[]" value="vintage_antique">Vintage/Antique</label>
                            <label class="checkbox-option"><input type="checkbox" name="aesthetic[]" value="shabby_chic">Shabby Chic</label>
                            <label class="checkbox-option"><input type="checkbox" name="aesthetic[]" value="industrial">Industrial</label>
                            <label class="checkbox-option"><input type="checkbox" name="aesthetic[]" value="mix_all">Mix of all styles (broad appeal)</label>
                            <label class="checkbox-option"><input type="checkbox" name="aesthetic[]" value="other">Other: <input type="text" name="aesthetic_other" placeholder="Specify..." style="width: 250px; display: inline-block; margin-left: 8px;"></label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Ideal customer description:<br>In your own words, describe your perfect retail customer:</label>
                        <div class="question-helper">Example: "Independent coastal gift shops in affluent beach towns, $1-3M revenue, targeting tourists and second-home owners, farmhouse/coastal aesthetic with 40-60% margins"</div>
                        <textarea name="ideal_customer" placeholder="Describe your perfect retail customer..."></textarea>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Geographic focus:<br>Where should we find leads?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="geographic_focus" value="all_us">Entire United States (all 50 states)</label>
                            <label class="radio-option"><input type="radio" name="geographic_focus" value="regions">OR specific regions (check all that apply):</label>
                        </div>
                        <div class="checkbox-group" style="margin-top: 12px; margin-left: 20px;">
                            <label class="checkbox-option"><input type="checkbox" name="regions[]" value="northeast">Northeast (NY, PA, NJ, MA, CT, RI, VT, NH, ME)</label>
                            <label class="checkbox-option"><input type="checkbox" name="regions[]" value="southeast">Southeast (FL, GA, SC, NC, VA, TN, AL, MS, LA, AR)</label>
                            <label class="checkbox-option"><input type="checkbox" name="regions[]" value="midwest">Midwest (IL, OH, MI, WI, MN, IN, IA, MO, KS, NE, SD, ND)</label>
                            <label class="checkbox-option"><input type="checkbox" name="regions[]" value="southwest">Southwest (TX, AZ, NM, OK)</label>
                            <label class="checkbox-option"><input type="checkbox" name="regions[]" value="west_coast">West Coast (CA, OR, WA)</label>
                            <label class="checkbox-option"><input type="checkbox" name="regions[]" value="mountain_west">Mountain West (CO, UT, ID, MT, WY, NV)</label>
                        </div>
                        <div class="radio-group" style="margin-top: 16px;">
                            <label class="radio-option"><input type="radio" name="geographic_focus" value="specific_states">OR specific states only:</label>
                        </div>
                        <input type="text" name="specific_states" placeholder="List states..." style="margin-top: 12px; margin-left: 20px;">
                    </div>

                    <div class="question-group">
                        <label class="question-label">Target lead volume:<br>How many NEW leads per month do you want?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="target_lead_volume" value="500">500 leads/month</label>
                            <label class="radio-option"><input type="radio" name="target_lead_volume" value="750">750 leads/month</label>
                            <label class="radio-option"><input type="radio" name="target_lead_volume" value="1000">1,000 leads/month</label>
                            <label class="radio-option"><input type="radio" name="target_lead_volume" value="1500">1,500 leads/month</label>
                            <label class="radio-option"><input type="radio" name="target_lead_volume" value="2000+">2,000+ leads/month</label>
                            <label class="radio-option"><input type="radio" name="target_lead_volume" value="start_small">Start smaller and scale based on results</label>
                        </div>
                        <div class="question-helper">Target number:</div>
                        <input type="number" name="target_lead_exact" placeholder="leads/month" min="0">
                    </div>

                    <div class="question-group">
                        <label class="question-label">Email sequence before calling:<br>How many emails should we send before AI makes a call?</label>
                        <div class="radio-group">
                            <label class="radio-option"><input type="radio" name="email_sequence" value="1_email">1 email → AI calls if they open/click (fast, lean approach) ← RECOMMENDED</label>
                            <label class="radio-option"><input type="radio" name="email_sequence" value="2-3_emails">2-3 email sequence → AI calls most engaged prospects</label>
                            <label class="radio-option"><input type="radio" name="email_sequence" value="email_only">Email-only (no AI calls, just email campaign)</label>
                            <label class="radio-option"><input type="radio" name="email_sequence" value="no_email">No email (AI calls cold, no email warm-up)</label>
                            <label class="radio-option"><input type="radio" name="email_sequence" value="other">Other: <input type="text" name="email_sequence_other" placeholder="Specify..." style="width: 250px; display: inline-block; margin-left: 8px;"></label>
                        </div>
                    </div>

                    <div class="question-group">
                        <label class="question-label">Engagement tracking:<br>What engagement metrics should we track?</label>
                        <div class="checkbox-group">
                            <label class="checkbox-option"><input type="checkbox" name="engagement_metrics[]" value="email_opens">Email opens</label>
                            <label class="checkbox-option"><input type="checkbox" name="engagement_metrics[]" value="link_clicks">Email link clicks</label>
                            <label class="checkbox-option"><input type="checkbox" name="engagement_metrics[]" value="catalog_downloads">Catalog downloads</label>
                            <label class="checkbox-option"><input type="checkbox" name="engagement_metrics[]" value="website_visits">Website visits (if we add tracking pixel)</label>
                            <label class="checkbox-option"><input type="checkbox" name="engagement_metrics[]" value="email_replies">Email replies</label>
                            <label class="checkbox-option"><input type="checkbox" name="engagement_metrics[]" value="all">All of the above ← We recommend this, gives us ability to scale in future and make informed decisions</label>
                            <label class="checkbox-option"><input type="checkbox" name="engagement_metrics[]" value="other">Other: <input type="text" name="engagement_metrics_other" placeholder="Specify..." style="width: 250px; display: inline-block; margin-left: 8px;"></label>
                        </div>
                    </div>
                </div>

                <button type="submit" class="submit-button">Submit Questionnaire</button>
            </form>
        </div>
    </section>

    <div class="autosave-indicator" id="autosaveIndicator" aria-live="polite">Saved</div>

    <!-- Thank You Section -->
    <section class="thank-you-section" id="thankYouSection">
        <canvas class="thank-you-canvas" id="thankYouCanvas"></canvas>
        <div class="thank-you-content">
            <h1>We Got Your Submission</h1>
            <p>Thank you for completing the questionnaire! We will review your responses and get back to you shortly.</p>
            <button class="submit-again-button" id="submitAgainButton">Submit Another Response</button>
        </div>
    </section>

    <!-- Three.js Library -->
    <script src="https://unpkg.com/three@0.150.1/build/three.min.js"></script>

    <script>
        // Three.js Animated Background
        let animationId;

        function createWaveScene({ canvas, backgroundHex, lineHex, opacity }) {
            try {
                if (!canvas) {
                    console.error('Canvas not found');
                    return null;
                }

                const width = canvas.clientWidth || window.innerWidth;
                const height = canvas.clientHeight || window.innerHeight;

                // Scene
                const localScene = new THREE.Scene();
                localScene.background = new THREE.Color(backgroundHex);

                // Camera
                const localCamera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
                localCamera.position.set(0, 0, 8);

                // Renderer
                const localRenderer = new THREE.WebGLRenderer({ 
                    canvas: canvas,
                    antialias: true,
                    alpha: false
                });
                localRenderer.setSize(width, height);
                localRenderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

                // Create wave-like mountainous pattern
                const segments = 200;
                const lines = [];
                const lineMaterial = new THREE.LineBasicMaterial({
                    color: lineHex,
                    transparent: true,
                    opacity,
                    linewidth: 1
                });

                // Create multiple layers of wave lines
                for (let layer = 0; layer < 120; layer++) {
                    const geometry = new THREE.BufferGeometry();
                    const positions = [];
                    const y = (layer / 120 - 0.5) * 18;

                    for (let i = 0; i <= segments; i++) {
                        const x = (i / segments - 0.5) * 30;
                        // Create wave pattern with multiple frequencies for depth
                        const z = Math.sin(x * 0.2 + layer * 0.1) * 2 + 
                                  Math.cos(x * 0.4 + layer * 0.08) * 1.2 +
                                  Math.sin(x * 0.6 + layer * 0.15) * 0.8;
                        
                        positions.push(x, y, z);
                    }

                    geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
                    
                    const line = new THREE.Line(geometry, lineMaterial);
                    localScene.add(line);
                    lines.push(line);
                }

                return { scene: localScene, camera: localCamera, renderer: localRenderer, particles: lines, canvas };
            } catch (error) {
                console.error('Error initializing Three.js:', error);
                return null;
            }
        }

        function initThreeJS() {
            // Hero background
            const heroCanvas = document.getElementById('heroCanvas');
            const heroBundle = createWaveScene({
                canvas: heroCanvas,
                backgroundHex: 0xF7F4EF,
                lineHex: 0x6F6F6F,
                opacity: 0.3
            });

            // Form background
            const formCanvas = document.getElementById('formCanvas');
            let formBundle = null;
            if (formCanvas) {
                formBundle = createWaveScene({
                    canvas: formCanvas,
                    backgroundHex: 0xF7F4EF,
                    lineHex: 0x6F6F6F,
                    opacity: 0.3
                });
            }

            // Thank you background (animated like hero)
            const thankYouCanvas = document.getElementById('thankYouCanvas');
            let thankYouBundle = null;
            if (thankYouCanvas) {
                thankYouBundle = createWaveScene({
                    canvas: thankYouCanvas,
                    backgroundHex: 0xF7F4EF,
                    lineHex: 0x6F6F6F,
                    opacity: 0.3
                });
            }

            let heroScene, heroCamera, heroRenderer, heroParticles;
            let formScene, formCamera, formRenderer, formParticles;
            let thankYouScene, thankYouCamera, thankYouRenderer, thankYouParticles;

            if (heroBundle) {
                ({ scene: heroScene, camera: heroCamera, renderer: heroRenderer, particles: heroParticles } = heroBundle);
            }

            if (formBundle) {
                ({ scene: formScene, camera: formCamera, renderer: formRenderer, particles: formParticles } = formBundle);
            }

            if (thankYouBundle) {
                ({ scene: thankYouScene, camera: thankYouCamera, renderer: thankYouRenderer, particles: thankYouParticles } = thankYouBundle);
            }

            // Render form waves once (stationary)
            if (formParticles && formRenderer && formScene && formCamera) {
                formRenderer.render(formScene, formCamera);
            }

            let time = 0;
            function animateAll() {
                animationId = requestAnimationFrame(animateAll);
                time += 0.01;

                // Animate hero waves
                if (heroParticles && heroRenderer && heroScene && heroCamera) {
                    heroParticles.forEach((line, i) => {
                        const positions = line.geometry.attributes.position;
                        for (let j = 0; j < positions.count; j++) {
                            const x = positions.getX(j);
                            const z = Math.sin(x * 0.2 + i * 0.1 + time) * 2 + 
                                      Math.cos(x * 0.4 + i * 0.08 + time * 0.8) * 1.2 +
                                      Math.sin(x * 0.6 + i * 0.15 + time * 0.6) * 0.8;
                            positions.setZ(j, z);
                        }
                        positions.needsUpdate = true;
                    });
                    heroRenderer.render(heroScene, heroCamera);
                }

                // Animate thank you waves (same as hero)
                if (thankYouParticles && thankYouRenderer && thankYouScene && thankYouCamera) {
                    thankYouParticles.forEach((line, i) => {
                        const positions = line.geometry.attributes.position;
                        for (let j = 0; j < positions.count; j++) {
                            const x = positions.getX(j);
                            const z = Math.sin(x * 0.2 + i * 0.1 + time) * 2 + 
                                      Math.cos(x * 0.4 + i * 0.08 + time * 0.8) * 1.2 +
                                      Math.sin(x * 0.6 + i * 0.15 + time * 0.6) * 0.8;
                            positions.setZ(j, z);
                        }
                        positions.needsUpdate = true;
                    });
                    thankYouRenderer.render(thankYouScene, thankYouCamera);
                }
            }

            animateAll();

            // Handle resize for hero
            window.addEventListener('resize', () => {
                if (heroRenderer && heroCamera && heroCanvas) {
                    const w = heroCanvas.clientWidth || window.innerWidth;
                    const h = heroCanvas.clientHeight || window.innerHeight;
                    heroCamera.aspect = w / h;
                    heroCamera.updateProjectionMatrix();
                    heroRenderer.setSize(w, h);
                }

                if (formRenderer && formCamera && formCanvas && formScene) {
                    const w = formCanvas.clientWidth || window.innerWidth;
                    const h = formCanvas.clientHeight || window.innerHeight;
                    formCamera.aspect = w / h;
                    formCamera.updateProjectionMatrix();
                    formRenderer.setSize(w, h);
                    // Re-render stationary form waves after resize
                    formRenderer.render(formScene, formCamera);
                }

                if (thankYouRenderer && thankYouCamera && thankYouCanvas && thankYouScene) {
                    const w = thankYouCanvas.clientWidth || window.innerWidth;
                    const h = thankYouCanvas.clientHeight || window.innerHeight;
                    thankYouCamera.aspect = w / h;
                    thankYouCamera.updateProjectionMatrix();
                    thankYouRenderer.setSize(w, h);
                }
            });
        }

        // Initialize Three.js when page loads
        function checkThreeJS() {
            if (typeof THREE !== 'undefined') {
                setTimeout(initThreeJS, 100);
            } else {
                console.error('Three.js library not loaded');
                setTimeout(checkThreeJS, 500);
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', checkThreeJS);
        } else {
            checkThreeJS();
        }

        // Scroll to form functionality
        const scrollDownButton = document.getElementById('scrollDownButton');
        const formSection = document.querySelector('.form-section');

        if (scrollDownButton && formSection) {
            scrollDownButton.addEventListener('click', () => {
                formSection.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            });
        }

        // Auto-save functionality - Enhanced for persistence
        let autosaveToastTimer = null;
        let saveDebounceTimer = null;
        let lastSaveTime = null;

        function flashAutosave() {
            const el = document.getElementById('autosaveIndicator');
            if (!el) return;
            el.classList.add('show');
            el.textContent = '✓ Saved';
            if (autosaveToastTimer) window.clearTimeout(autosaveToastTimer);
            autosaveToastTimer = window.setTimeout(() => el.classList.remove('show'), 2000);
        }

        // Authentication system
        const VALID_USERS = {
            'test': 'admin',
            'kalalou': 'teamkalalou'
        };

        function getCurrentUser() {
            return sessionStorage.getItem('current_user') || localStorage.getItem('current_user');
        }

        function setCurrentUser(username) {
            sessionStorage.setItem('current_user', username);
            localStorage.setItem('current_user', username);
        }

        function clearCurrentUser() {
            sessionStorage.removeItem('current_user');
            localStorage.removeItem('current_user');
        }

        function authenticate(username, password) {
            const normalizedUsername = username.toLowerCase().trim();
            const normalizedPassword = password.toLowerCase().trim();
            
            if (VALID_USERS[normalizedUsername] === normalizedPassword) {
                return normalizedUsername;
            }
            return null;
        }

        function getFormKey() {
            const username = getCurrentUser();
            if (!username) {
                return 'hero_questionnaire_data';
            }
            return `hero_questionnaire_data_${username}`;
        }

        function isLocalStorageAvailable() {
            try {
                const test = '__localStorage_test__';
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                return true;
            } catch (e) {
                return false;
            }
        }

        function saveFormData(form) {
            if (!form) return;
            
            // Check if localStorage is available
            if (!isLocalStorageAvailable()) {
                console.warn('LocalStorage is not available. Progress cannot be saved.');
                return;
            }

            try {
                const formData = new FormData(form);
                const data = {};

                formData.forEach((value, key) => {
                    // Skip empty values for cleaner storage
                    if (value && value.toString().trim() !== '') {
                        if (data[key]) {
                            if (Array.isArray(data[key])) {
                                data[key].push(value);
                            } else {
                                data[key] = [data[key], value];
                            }
                        } else {
                            data[key] = value;
                        }
                    }
                });

                // Add timestamp
                data._lastSaved = new Date().toISOString();

                // Save to localStorage
                const dataString = JSON.stringify(data);
                localStorage.setItem(getFormKey(), dataString);
                
                lastSaveTime = new Date();
                flashAutosave();
                
                console.log('Form data saved at', lastSaveTime.toLocaleTimeString());
            } catch (error) {
                console.error('Error saving form data:', error);
                // Try to save a simplified version if storage is full
                try {
                    const formData = new FormData(form);
                    const data = {};
                    let itemCount = 0;
                    formData.forEach((value, key) => {
                        if (value && value.toString().trim() !== '' && itemCount < 50) {
                            data[key] = value;
                            itemCount++;
                        }
                    });
                    data._lastSaved = new Date().toISOString();
                    localStorage.setItem(getFormKey(), JSON.stringify(data));
                    console.log('Saved simplified version due to storage limit');
                } catch (e) {
                    console.error('Failed to save even simplified version:', e);
                }
            }
        }

        function loadFormData() {
            if (!isLocalStorageAvailable()) {
                console.warn('LocalStorage is not available. Cannot load saved data.');
                return;
            }

            const savedData = localStorage.getItem(getFormKey());
            if (!savedData) {
                console.log('No saved data found');
                return;
            }

            try {
                const data = JSON.parse(savedData);
                const form = document.getElementById('mainForm');
                if (!form) {
                    // Retry after a short delay if form isn't ready
                    setTimeout(loadFormData, 100);
                    return;
                }

                let loadedCount = 0;

                // Restore form values
                Object.keys(data).forEach(key => {
                    // Skip metadata keys
                    if (key.startsWith('_')) return;

                    const value = data[key];
                    const elements = form.querySelectorAll(`[name="${key}"]`);

                    if (elements.length === 0) return;

                    elements.forEach(element => {
                        if (element.type === 'checkbox' || element.type === 'radio') {
                            if (Array.isArray(value)) {
                                element.checked = value.includes(element.value);
                            } else {
                                element.checked = element.value === value;
                            }
                            if (element.checked) loadedCount++;
                        } else {
                            element.value = Array.isArray(value) ? value[0] : value;
                            if (element.value) loadedCount++;
                        }
                    });
                });

                if (loadedCount > 0) {
                    console.log(`Loaded ${loadedCount} saved form fields`);
                    if (data._lastSaved) {
                        const saveDate = new Date(data._lastSaved);
                        console.log('Last saved:', saveDate.toLocaleString());
                    }
                }
            } catch (error) {
                console.error('Error loading saved data:', error);
            }
        }

        // Debounced save function
        function debouncedSave(form) {
            if (saveDebounceTimer) {
                clearTimeout(saveDebounceTimer);
            }
            saveDebounceTimer = setTimeout(() => {
                saveFormData(form);
            }, 500); // Save 500ms after user stops typing
        }

        // Login functionality
        function initializeLogin() {
            const loginForm = document.getElementById('loginForm');
            const loginOverlay = document.getElementById('loginOverlay');
            const userInfo = document.getElementById('userInfo');
            const currentUsernameSpan = document.getElementById('currentUsername');
            const logoutBtn = document.getElementById('logoutBtn');
            const formSection = document.querySelector('.form-section');

            // Setup logout handler first (before any early returns)
            if (logoutBtn) {
                logoutBtn.addEventListener('click', function() {
                    // Save progress before logout
                    const form = document.getElementById('mainForm');
                    if (form) {
                        saveFormData(form);
                    }
                    
                    if (confirm('Are you sure you want to logout? Your progress has been saved.')) {
                        clearCurrentUser();
                        loginOverlay.classList.remove('hidden');
                        userInfo.classList.remove('show');
                        if (formSection) formSection.style.display = 'none';
                        
                        // Reset form display (but data is saved)
                        if (form) {
                            form.reset();
                        }
                        
                        // Reset login form and button
                        if (loginForm) {
                            loginForm.reset();
                        }
                        const loginButton = document.querySelector('.login-button');
                        if (loginButton) {
                            loginButton.disabled = false;
                            loginButton.textContent = 'Login';
                        }
                        const loginError = document.getElementById('loginError');
                        if (loginError) {
                            loginError.textContent = '';
                        }
                        
                        // Hide thank you section if visible
                        const thankYouSection = document.getElementById('thankYouSection');
                        if (thankYouSection) {
                            thankYouSection.classList.remove('show');
                        }
                        
                        // Scroll to top
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                });
            }

            // Check if user is already logged in
            const currentUser = getCurrentUser();
            if (currentUser) {
                loginOverlay.classList.add('hidden');
                userInfo.classList.add('show');
                currentUsernameSpan.textContent = currentUser;
                if (formSection) {
                    formSection.style.display = 'block';
                }
                // Initialize autosave for logged-in user
                setTimeout(() => {
                    initializeAutosave();
                    loadFormData();
                }, 100);
                return;
            }

            // Show login overlay if not logged in
            loginOverlay.classList.remove('hidden');
            if (formSection) formSection.style.display = 'none';

            // Handle login form submission
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                const loginError = document.getElementById('loginError');
                const usernameError = document.getElementById('usernameError');
                const passwordError = document.getElementById('passwordError');
                const loginButton = document.getElementById('loginButton');

                // Clear previous errors
                loginError.classList.remove('show');
                usernameError.classList.remove('show');
                passwordError.classList.remove('show');

                // Validate inputs
                if (!username.trim()) {
                    usernameError.classList.add('show');
                    return;
                }

                if (!password.trim()) {
                    passwordError.classList.add('show');
                    return;
                }

                // Authenticate
                loginButton.disabled = true;
                loginButton.textContent = 'Logging in...';

                setTimeout(() => {
                    const authenticatedUser = authenticate(username, password);
                    
                    if (authenticatedUser) {
                        setCurrentUser(authenticatedUser);
                        loginOverlay.classList.add('hidden');
                        userInfo.classList.add('show');
                        currentUsernameSpan.textContent = authenticatedUser;
                        if (formSection) {
                            formSection.style.display = 'block';
                        }
                        
                        // Load user-specific form data and initialize autosave
                        setTimeout(() => {
                            loadFormData();
                            initializeAutosave();
                        }, 100);
                    } else {
                        loginError.classList.add('show');
                        loginButton.disabled = false;
                        loginButton.textContent = 'Login';
                    }
                }, 300);
            });
        }

        // Initialize auto-save for form
        function initializeAutosave() {
            const form = document.getElementById('mainForm');
            if (!form) {
                // Retry if form isn't ready yet
                setTimeout(initializeAutosave, 100);
                return;
            }

            // Only initialize if user is logged in
            if (!getCurrentUser()) {
                return;
            }

            // Auto-save on input change (with debounce for text inputs)
            form.addEventListener('input', function(e) {
                // For text inputs, use debounced save
                if (e.target.type === 'text' || e.target.type === 'email' || 
                    e.target.type === 'tel' || e.target.type === 'number' || 
                    e.target.tagName === 'TEXTAREA') {
                    debouncedSave(this);
                } else {
                    // For other inputs, save immediately
                    saveFormData(this);
                }
            });

            // Auto-save on checkbox/radio change (immediate)
            form.addEventListener('change', function() {
                saveFormData(this);
            });

            // Auto-save on blur (when user leaves a field)
            form.addEventListener('blur', function() {
                saveFormData(this);
            }, true); // Use capture phase to catch all blur events

            // Periodic auto-save as backup (every 30 seconds)
            setInterval(() => {
                saveFormData(form);
            }, 30000);

            // Save on page unload as final safety net
            window.addEventListener('beforeunload', function() {
                saveFormData(form);
            });

            // Save when page becomes hidden (user switches tabs)
            document.addEventListener('visibilitychange', function() {
                if (document.hidden) {
                    saveFormData(form);
                }
            });

            // Handle form submission via Web3Forms (free, reliable)
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                // Show loading state
                const submitButton = this.querySelector('.submit-button');
                const originalButtonText = submitButton ? submitButton.textContent : 'Submit';
                if (submitButton) {
                    submitButton.textContent = 'Submitting...';
                    submitButton.disabled = true;
                }
                
                // Collect form data
                const formData = new FormData(this);
                const data = {};
                formData.forEach((value, key) => {
                    if (data[key]) {
                        if (Array.isArray(data[key])) {
                            data[key].push(value);
                        } else {
                            data[key] = [data[key], value];
                        }
                    } else {
                        data[key] = value;
                    }
                });
                
                console.log('Form data collected:', data);
                
                // Store submission locally as backup
                const submissions = JSON.parse(localStorage.getItem('form_submissions') || '[]');
                submissions.push({
                    timestamp: new Date().toISOString(),
                    user: getCurrentUser(),
                    data: data
                });
                localStorage.setItem('form_submissions', JSON.stringify(submissions));
                console.log('Form data saved locally as backup');
                
                // Build email body
                let emailBody = 'KalalouAI Questionnaire Submission\n';
                emailBody += '================================\n\n';
                emailBody += 'Submitted by: ' + (getCurrentUser() || 'Unknown') + '\n';
                emailBody += 'Date: ' + new Date().toLocaleString() + '\n\n';
                
                Object.keys(data).forEach(key => {
                    const value = Array.isArray(data[key]) ? data[key].join(', ') : data[key];
                    if (value && value.toString().trim() !== '') {
                        emailBody += key + ': ' + value + '\n';
                    }
                });
                
                try {
                    console.log('Starting Web3Forms submission...');
                    
                    // Send via Web3Forms
                    const web3FormData = new FormData();
                    web3FormData.append('access_key', 'ed24aadb-3f9d-4d4d-af6e-edb643aea0f8');
                    web3FormData.append('subject', 'KalalouAI Questionnaire - ' + new Date().toLocaleDateString());
                    web3FormData.append('from_name', 'KalalouAI Form');
                    web3FormData.append('message', emailBody);
                    
                    // Add all form fields
                    Object.keys(data).forEach(key => {
                        const value = Array.isArray(data[key]) ? data[key].join(', ') : data[key];
                        if (value && value.toString().trim() !== '') {
                            web3FormData.append(key, value);
                        }
                    });
                    
                    console.log('Sending to Web3Forms...');
                    
                    const response = await fetch('https://api.web3forms.com/submit', {
                        method: 'POST',
                        body: web3FormData
                    });
                    
                    console.log('Response status:', response.status);
                    const result = await response.json();
                    console.log('Web3Forms response:', result);
                    
                    if (submitButton) {
                        submitButton.textContent = originalButtonText;
                        submitButton.disabled = false;
                    }
                    
                    if (result.success) {
                        // Hide form and show thank you section
                        const formSection = document.querySelector('.form-section');
                        const thankYouSection = document.getElementById('thankYouSection');
                        
                        if (formSection) formSection.style.display = 'none';
                        if (thankYouSection) {
                            thankYouSection.classList.add('show');
                        }
                        
                        // Clear saved form data for current user
                        const formKey = getFormKey();
                        localStorage.removeItem(formKey);
                        form.reset();
                        
                        // Scroll to thank you section
                        if (thankYouSection) {
                            thankYouSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                        
                        console.log('Form submitted successfully!');
                    } else {
                        throw new Error(result.message || 'Submission failed');
                    }
                } catch (error) {
                    console.error('Web3Forms Error:', error);
                    console.error('Error message:', error.message);
                    console.error('Error stack:', error.stack);
                    if (submitButton) {
                        submitButton.textContent = originalButtonText;
                        submitButton.disabled = false;
                    }
                    alert('Error submitting form: ' + error.message + '\n\nYour data has been saved locally. Please check the browser console (F12) for details.');
                }
            });

            console.log('Autosave initialized - your progress is being saved automatically');
        }

        
        // Load saved data on page load - multiple strategies for reliability
        function initializeFormData() {
            // Check if returning from form submission
            const urlParams = new URLSearchParams(window.location.search);
            const wasSubmitted = urlParams.get('submitted') === 'true' || sessionStorage.getItem('form_submitted') === 'true';
            
            if (wasSubmitted) {
                // Clear the flag
                sessionStorage.removeItem('form_submitted');
                // Clean URL
                window.history.replaceState({}, document.title, window.location.pathname);
                
                // Show thank you section after login check
                setTimeout(() => {
                    const currentUser = getCurrentUser();
                    if (currentUser) {
                        const formSection = document.querySelector('.form-section');
                        const thankYouSection = document.getElementById('thankYouSection');
                        
                        if (formSection) formSection.style.display = 'none';
                        if (thankYouSection) {
                            thankYouSection.classList.add('show');
                            thankYouSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }
                }, 500);
            }
            
            // Initialize login first
            initializeLogin();
            
            // Only load form data if user is logged in
            const currentUser = getCurrentUser();
            if (!currentUser) {
                return;
            }
            
            // Try loading immediately
            loadFormData();
            
            // Also try after DOM is fully ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    loadFormData();
                    initializeAutosave();
                });
            } else {
                // DOM is already ready
                loadFormData();
                initializeAutosave();
            }
        }

        // Handle "Submit Again" button
        function initializeSubmitAgain() {
            const submitAgainButton = document.getElementById('submitAgainButton');
            const thankYouSection = document.getElementById('thankYouSection');
            const formSection = document.querySelector('.form-section');
            const form = document.getElementById('mainForm');

            if (submitAgainButton) {
                submitAgainButton.addEventListener('click', function() {
                    // Hide thank you section
                    if (thankYouSection) {
                        thankYouSection.classList.remove('show');
                    }
                    
                    // Show form section
                    if (formSection) {
                        formSection.style.display = 'block';
                    }
                    
                    // Reset form
                    if (form) {
                        form.reset();
                    }
                    
                    // Clear saved data
                    const formKey = getFormKey();
                    localStorage.removeItem(formKey);
                    
                    // Scroll to form
                    if (formSection) {
                        formSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            }
        }

        // Initialize everything
        initializeFormData();
        initializeSubmitAgain();
    </script>
</body>
</html>
